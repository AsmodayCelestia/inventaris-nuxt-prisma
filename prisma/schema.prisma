generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model activity_log {
  id           BigInt    @id @default(autoincrement())
  log_name     String?   @db.VarChar(255)
  description  String
  subject_type String?   @db.VarChar(255)
  subject_id   BigInt?
  causer_type  String?   @db.VarChar(255)
  causer_id    BigInt?
  properties   Json?     @db.Json
  created_at   DateTime? @db.Timestamp(0)
  updated_at   DateTime? @db.Timestamp(0)
  event        String?   @db.VarChar(255)
  batch_uuid   String?   @db.Uuid

  @@index([log_name], map: "activity_log_log_name_index")
  @@index([causer_type, causer_id], map: "causer")
  @@index([subject_type, subject_id], map: "subject")
}

model brands {
  id              BigInt            @id @default(autoincrement())
  name            String            @unique(map: "brands_name_unique") @db.VarChar(255)
  created_at      DateTime?         @db.Timestamp(0)
  updated_at      DateTime?         @db.Timestamp(0)
  inventory_items inventory_items[]
}

model cache {
  key        String @id @db.VarChar(255)
  value      String
  expiration Int
}

model cache_locks {
  key        String @id @db.VarChar(255)
  owner      String @db.VarChar(255)
  expiration Int
}

model categories {
  id              BigInt            @id @default(autoincrement())
  name            String            @unique(map: "categories_name_unique") @db.VarChar(255)
  created_at      DateTime?         @db.Timestamp(0)
  updated_at      DateTime?         @db.Timestamp(0)
  inventory_items inventory_items[]
}

model divisions {
  id         BigInt    @id @default(autoincrement())
  name       String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  users      users[]
}

model floors {
  id             BigInt         @id @default(autoincrement())
  number         String         @db.VarChar(255)
  unit_id        BigInt
  created_at     DateTime?      @db.Timestamp(0)
  updated_at     DateTime?      @db.Timestamp(0)
  location_units location_units @relation(fields: [unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "floors_unit_id_foreign")
  rooms          rooms[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model inventories {
  id                          BigInt                   @id @default(autoincrement())
  inventory_number            String                   @unique(map: "inventories_inventory_number_unique") @db.VarChar(255)
  inventory_item_id           BigInt
  acquisition_source          String                   @default("-") @db.VarChar(255)
  procurement_date            DateTime                 @db.Date
  purchase_price              Decimal                  @db.Decimal(15, 2)
  estimated_depreciation      Decimal?                 @db.Decimal(15, 2)
  status                      String                   @default("Ada") @db.VarChar(255)
  image_path                  String?                  @db.VarChar(255)
  qr_code_path                String?                  @db.VarChar(255)
  unit_id                     BigInt
  room_id                     BigInt
  expected_replacement        DateTime?                @db.Date
  last_checked_at             DateTime?                @db.Date
  pj_id                       BigInt?
  maintenance_frequency_type  String?                  @db.VarChar(255)
  maintenance_frequency_value Int?
  last_maintenance_at         DateTime?                @db.Date
  next_due_date               DateTime?                @db.Date
  next_due_km                 Int?
  last_odometer_reading       Int?
  created_at                  DateTime?                @db.Timestamp(0)
  updated_at                  DateTime?                @db.Timestamp(0)
  inventory_items             inventory_items          @relation(fields: [inventory_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventories_inventory_item_id_foreign")
  users                       users?                   @relation(fields: [pj_id], references: [id], onUpdate: NoAction, map: "inventories_pj_id_foreign")
  rooms                       rooms                    @relation(fields: [room_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventories_room_id_foreign")
  location_units              location_units           @relation(fields: [unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventories_unit_id_foreign")
  inventory_maintenances      inventory_maintenances[]
}

model inventory_items {
  id               BigInt        @id @default(autoincrement())
  item_code        String        @unique(map: "inventory_items_item_code_unique") @db.VarChar(255)
  name             String        @db.VarChar(255)
  quantity         Int
  brand_id         BigInt
  category_id      BigInt
  type_id          BigInt
  manufacturer     String        @db.VarChar(255)
  manufacture_year Int
  isbn             String?       @db.VarChar(255)
  image_path       String?       @db.VarChar(255)
  created_at       DateTime?     @db.Timestamp(0)
  updated_at       DateTime?     @db.Timestamp(0)
  inventories      inventories[]
  brands           brands        @relation(fields: [brand_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventory_items_brand_id_foreign")
  categories       categories    @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventory_items_category_id_foreign")
  item_types       item_types    @relation(fields: [type_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventory_items_type_id_foreign")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model inventory_maintenances {
  id                                             BigInt      @id @default(autoincrement())
  inventory_id                                   BigInt
  inspection_date                                DateTime    @db.Date
  issue_found                                    String?
  solution_taken                                 String?
  notes                                          String?
  status                                         String      @default("reported") @db.VarChar(255)
  cost                                           Decimal?    @db.Decimal(15, 0)
  photo_1                                        String?     @db.VarChar(255)
  photo_2                                        String?     @db.VarChar(255)
  photo_3                                        String?     @db.VarChar(255)
  user_id                                        BigInt?
  odometer_reading                               Int?
  creator_id                                     BigInt?
  created_at                                     DateTime?   @db.Timestamp(0)
  updated_at                                     DateTime?   @db.Timestamp(0)
  deleted_at                                     DateTime?   @db.Timestamp(0)
  users_inventory_maintenances_creator_idTousers users?      @relation("inventory_maintenances_creator_idTousers", fields: [creator_id], references: [id], onUpdate: NoAction, map: "inventory_maintenances_creator_id_foreign")
  inventories                                    inventories @relation(fields: [inventory_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "inventory_maintenances_inventory_id_foreign")
  users_inventory_maintenances_user_idTousers    users?      @relation("inventory_maintenances_user_idTousers", fields: [user_id], references: [id], onUpdate: NoAction, map: "inventory_maintenances_user_id_foreign")
}

model item_types {
  id              BigInt            @id @default(autoincrement())
  name            String            @unique(map: "item_types_name_unique") @db.VarChar(255)
  created_at      DateTime?         @db.Timestamp(0)
  updated_at      DateTime?         @db.Timestamp(0)
  inventory_items inventory_items[]
}

model location_units {
  id          BigInt        @id @default(autoincrement())
  name        String        @unique(map: "location_units_name_unique") @db.VarChar(255)
  created_at  DateTime?     @db.Timestamp(0)
  updated_at  DateTime?     @db.Timestamp(0)
  floors      floors[]
  inventories inventories[]
}

model media {
  id            BigInt    @id @default(autoincrement())
  medially_type String    @db.VarChar(255)
  medially_id   BigInt
  file_url      String
  file_name     String    @db.VarChar(255)
  file_type     String?   @db.VarChar(255)
  size          BigInt
  created_at    DateTime? @db.Timestamp(0)
  updated_at    DateTime? @db.Timestamp(0)

  @@index([medially_type, medially_id], map: "media_medially_type_medially_id_index")
}

model migrations {
  id        Int    @id @default(autoincrement())
  migration String @db.VarChar(255)
  batch     Int
}

model personal_access_tokens {
  id             BigInt    @id @default(autoincrement())
  tokenable_type String    @db.VarChar(255)
  tokenable_id   BigInt
  name           String
  token          String    @unique(map: "personal_access_tokens_token_unique") @db.VarChar(64)
  abilities      String?
  last_used_at   DateTime? @db.Timestamp(0)
  expires_at     DateTime? @db.Timestamp(0)
  created_at     DateTime? @db.Timestamp(0)
  updated_at     DateTime? @db.Timestamp(0)

  @@index([tokenable_type, tokenable_id], map: "personal_access_tokens_tokenable_type_tokenable_id_index")
}

model rooms {
  id           BigInt        @id @default(autoincrement())
  name         String        @db.VarChar(255)
  floor_id     BigInt
  pj_lokasi_id BigInt?
  created_at   DateTime?     @db.Timestamp(0)
  updated_at   DateTime?     @db.Timestamp(0)
  inventories  inventories[]
  floors       floors        @relation(fields: [floor_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "rooms_floor_id_foreign")
  users        users?        @relation(fields: [pj_lokasi_id], references: [id], onUpdate: NoAction, map: "rooms_pj_lokasi_id_foreign")
}

model sessions {
  id            String  @id @db.VarChar(255)
  user_id       BigInt?
  ip_address    String? @db.VarChar(45)
  user_agent    String?
  payload       String
  last_activity Int

  @@index([last_activity], map: "sessions_last_activity_index")
  @@index([user_id], map: "sessions_user_id_index")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model users {
  id                                                              BigInt                   @id @default(autoincrement())
  name                                                            String                   @db.VarChar(255)
  email                                                           String                   @unique(map: "users_email_unique") @db.VarChar(255)
  password                                                        String                   @db.VarChar(255)
  division_id                                                     BigInt?
  role                                                            String                   @db.VarChar(255)
  is_room_supervisor                                              Boolean                  @default(false)
  is_pj_maintenance                                               Boolean                  @default(false)
  remember_token                                                  String?                  @db.VarChar(100)
  created_at                                                      DateTime?                @db.Timestamp(0)
  updated_at                                                      DateTime?                @db.Timestamp(0)
  inventories                                                     inventories[]
  inventory_maintenances_inventory_maintenances_creator_idTousers inventory_maintenances[] @relation("inventory_maintenances_creator_idTousers")
  inventory_maintenances_inventory_maintenances_user_idTousers    inventory_maintenances[] @relation("inventory_maintenances_user_idTousers")
  rooms                                                           rooms[]
  divisions                                                       divisions?               @relation(fields: [division_id], references: [id], onUpdate: NoAction, map: "users_division_id_foreign")
}
